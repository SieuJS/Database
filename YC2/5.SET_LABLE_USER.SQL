CONN lbacsys/123@LOCALHOST:1521/XEPDB1; 
ALTER SESSION SET CURRENT_SCHEMA = QLDLNB;
DECLARE
    CURSOR CUR IS (
        SELECT 'NV'||MANV 
        FROM NHANSU
        WHERE VAITRO = 'Trưởng khoa'
    );
BEGIN
    SA_USER_ADMIN.SET_USER_LABELS('PC_OLS_QLDLNB','NV600','TK', 'TK');
END;

/
DECLARE 
    CURSOR CUR IS (
        SELECT
            'SV'||MASV
        FROM
            QLDLNB.SINHVIEN
        WHERE
            'SV'||MASV IN (
                SELECT
                    USERNAME
                FROM
                    ALL_USERS
            )
    );
    SV_LABEL VARCHAR2(100);
    MASV_ VARCHAR2(100);
    MANGANH_ VARCHAR(100);
    COSO_ VARCHAR(100);
    STRSQL VARCHAR2(100);
BEGIN
    OPEN CUR;
    LOOP
   FETCH CUR INTO MASV_;
   EXIT WHEN CUR%NOTFOUND;
      SELECT MANGANH, COSO INTO MANGANH_, COSO_
      FROM SINHVIEN
      WHERE 'SV'||MASV = MASV_;
      
      IF COSO_ = 'Cơ sở 1' THEN 
         COSO_ := 'CS1';
      ELSIF COSO_ = 'Cơ sở 2' THEN 
         COSO_ := 'CS2';
      END IF;
      
    SV_LABEL := 'SV:' || MANGANH_ || ':' || COSO_;

    STRSQL := 'EXECUTE SA_USER_ADMIN.SET_USER_LABELS(''PC_OLS_QLDLNB'',:1,:2,:2)';
    EXECUTE IMMEDIATE STRSQL USING MASV_, SV_LABEL;
END LOOP;
CLOSE CUR;
END ;
/

exec SA_USER_ADMIN.SET_USER_LABELS('PC_OLS_QLDLNB','SV712','SV:HTTT:CS1','SV:HTTT:CS1');

