CONN lbacsys/123@LOCALHOST:1521/XEPDB1; 
ALTER SESSION SET CURRENT_SCHEMA = QLDLNB_PDB1;

BEGIN
SA_POLICY_ADMIN.APPLY_TABLE_POLICY(
    POLICY_NAME  => 'PC_OLS_QLDLNB',
    SCHEMA_NAME  => 'QLDLNB_PDB1',
    TABLE_NAME  => 'THONGBAO',
    TABLE_OPTIONS  => NULL
);
END;
/

UPDATE THONGBAO SET OLS_THONGBAO=CHAR_TO_LABEL('PC_OLS_QLDLNB', 'TDV') WHERE MaTB=1;
UPDATE THONGBAO SET OLS_THONGBAO=CHAR_TO_LABEL('PC_OLS_QLDLNB', 'GVU') WHERE MaTB=2;
UPDATE THONGBAO SET OLS_THONGBAO=CHAR_TO_LABEL('PC_OLS_QLDLNB', 'TDV') WHERE MaTB=3;
UPDATE THONGBAO SET OLS_THONGBAO=CHAR_TO_LABEL('PC_OLS_QLDLNB', 'SV:HTTT:CS1') WHERE MaTB=4;
UPDATE THONGBAO SET OLS_THONGBAO=CHAR_TO_LABEL('PC_OLS_QLDLNB', 'TDV:KHMT') WHERE MaTB=5;
UPDATE THONGBAO SET OLS_THONGBAO=CHAR_TO_LABEL('PC_OLS_QLDLNB', 'TDV:KHMT:CS1') WHERE MaTB=6;

COMMIT;


BEGIN
SA_POLICY_ADMIN.REMOVE_TABLE_POLICY(
    POLICY_NAME  => 'PC_OLS_QLDLNB',
    SCHEMA_NAME  => 'QLDLNB_PDB1',
    TABLE_NAME  => 'THONGBAO',
    DROP_COLUMN => FALSE
);
END;
/
BEGIN
SA_POLICY_ADMIN.APPLY_TABLE_POLICY(
    POLICY_NAME  => 'PC_OLS_QLDLNB',
    SCHEMA_NAME  => 'QLDLNB_PDB1',
    TABLE_NAME  => 'THONGBAO',
    TABLE_OPTIONS  => 'READ_CONTROL, WRITE_CONTROL, CHECK_CONTROL'
);
END;
/

-- TRUONG KHOA DOC THONG BAO

BEGIN
SA_USER_ADMIN.SET_USER_LABELS(
    POLICY_NAME  =>'PC_OLS_QLDLNB',
    USER_NAME  => 'TRGKHOA',
    MAX_READ_LABEL  => 'TK:HTTT,KHMT,CNPM,TGMT,CNTT,MMT:HCMUS',
    MAX_WRITE_LABEL  => 'TK:HTTT,KHMT,CNPM,TGMT,CNTT,MMT:HCMUS'
);
END;
/

BEGIN
SA_USER_ADMIN.SET_USER_LABELS(
    POLICY_NAME  =>'PC_OLS_QLDLNB',
    USER_NAME  => 'TRGBMCS2',
    MAX_READ_LABEL  => 'TDV::CS2,CS1',
    MAX_WRITE_LABEL  => 'TDV::CS2,CS1'
);
END;
/
BEGIN
SA_USER_ADMIN.SET_USER_LABELS(
    POLICY_NAME  =>'PC_OLS_QLDLNB',
    USER_NAME  => 'TRGHTTT',
    MAX_READ_LABEL  => 'TDV:HTTT:CS2',
    MAX_WRITE_LABEL  => 'TDV:HTTT:CS2'
);
END;
/

BEGIN
SA_USER_ADMIN.SET_USER_LABELS(
    POLICY_NAME  =>'PC_OLS_QLDLNB',
    USER_NAME  => 'GIAOVU',
    MAX_READ_LABEL  => 'GVU:HTTT,KHMT,CNPM,TGMT,CNTT,MMT:CS1,CS2',
    MAX_WRITE_LABEL  => 'GVU:HTTT,KHMT,CNPM,TGMT,CNTT,MMT:CS1,CS2'
);
END;
/

BEGIN
SA_USER_ADMIN.SET_USER_LABELS(
    POLICY_NAME  =>'PC_OLS_QLDLNB',
    USER_NAME  => 'SVHTTT',
    MAX_READ_LABEL  => 'SV:HTTT:CS1',
    MAX_WRITE_LABEL  => 'SV:HTTT:CS1'
);
END;
/

BEGIN
SA_USER_ADMIN.SET_USER_LABELS(
    POLICY_NAME  =>'PC_OLS_QLDLNB',
    USER_NAME  => 'TRGKHMT',
    MAX_READ_LABEL  => 'TDV:KHMT:CS2',
    MAX_WRITE_LABEL  => 'TDV:KHMT:CS2'
);
END;
/