connect sys/123@localhost:1521/XEPDB1 AS SYSDBA ; 
ALTER SESSION SET CURRENT_SCHEMA = QLDLNB; 

BEGIN
DBMS_FGA.DROP_POLICY(OBJECT_SCHEMA  => 'QLDLNB' /*IN VARCHAR2*/,
                     OBJECT_NAME  => 'DANGKY' /*IN VARCHAR2*/,
                     POLICY_NAME  => 'AUDIT_DANGKY' /*IN VARCHAR2*/);
END ;
/

BEGIN 
    DBMS_FGA.ADD_POLICY(
        OBJECT_SCHEMA => 'QLDLNB',
        OBJECT_NAME => 'DANGKY',
        POLICY_NAME => 'AUDIT_DANGKY',
        AUDIT_CONDITION => 'SYS_CONTEXT(''USERENV'', ''SESSION_USER'') NOT LIKE''NV3%''' ,
        AUDIT_COLUMN => 'DIEMCK, DIEMQT, DIEMTH, DIEMTK',
        ENABLE => TRUE,
        STATEMENT_TYPES => 'UPDATE, SELECT'
    );
END;
/


BEGIN
    DBMS_FGA.ENABLE_POLICY (
        OBJECT_SCHEMA => 'QLDLNB',
        OBJECT_NAME => 'DANGKY',
        POLICY_NAME => 'AUDIT_DANGKY'
    );
END ;
/

BEGIN
DBMS_FGA.DROP_POLICY(OBJECT_SCHEMA  => 'QLDLNB' /*IN VARCHAR2*/,
                     OBJECT_NAME  => 'NHANSU' /*IN VARCHAR2*/,
                     POLICY_NAME  => 'AUDIT_NHANSU' /*IN VARCHAR2*/);
END ;
/

BEGIN 
    DBMS_FGA.ADD_POLICY(
        OBJECT_SCHEMA => 'QLDLNB',
        OBJECT_NAME => 'NHANSU',
        POLICY_NAME => 'AUDIT_NHANSU',
        AUDIT_CONDITION => '''NV''||MANV <> SYS_CONTEXT(''USERENV'',''SESSION_USER'') ',
        ENABLE => TRUE,
        STATEMENT_TYPES => 'SELECT'
    );
END;
/


BEGIN
    DBMS_FGA.ENABLE_POLICY (
        OBJECT_SCHEMA => 'QLDLNB',
        OBJECT_NAME => 'NHANSU',
        POLICY_NAME => 'AUDIT_NHANSU'
    );
END ;
/

DESC DBA_FGA_AUDIT_TRAIL;




